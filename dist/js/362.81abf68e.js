"use strict";(self["webpackChunksupermall"]=self["webpackChunksupermall"]||[]).push([[362],{7015:function(s,e,t){t.r(e),t.d(e,{default:function(){return fs}});var o=function(){var s=this,e=s.$createElement,t=s._self._c||e;return t("div",{attrs:{id:"detail"}},[t("detail-nav-bar",{ref:"NavBar",attrs:{tablist:["商品","参数","评论","推荐"]},on:{scrollToActiveSite:s.scrollToActiveSite}}),t("scroll",{ref:"scroller",attrs:{"probe-type":3,"pull-up-load":!0},on:{bescroll:s.bescroll}},[t("detail-swiper",{attrs:{topimges:s.topimges}}),t("detail-goods-message",{attrs:{"goods-message":s.goodsMessage}}),t("detail-shop-message",{attrs:{"shop-message":s.shopMessage}}),t("detail-goods-info",{attrs:{"goods-info":s.goodsInfo}}),t("detail-goods-size",{ref:"goodsSize",attrs:{"goods-size":s.goodsSize}}),t("detail-user-rate",{ref:"userRate",attrs:{"user-rate":s.userRate}}),t("div",{staticClass:"recommend"},[s._v(" 相关推荐 ")]),t("goods-list",{ref:"recommends",attrs:{goods:s.recommends}})],1),t("ScrollBack",{directives:[{name:"show",rawName:"v-show",value:s.isbackshow,expression:"isbackshow"}],nativeOn:{click:function(e){return s.backToTop.apply(null,arguments)}}}),t("detail-bottom-bar",{on:{addToCart:s.addToCart}})],1)},a=[],i=t(7957),r=function(){var s=this,e=s.$createElement,o=s._self._c||e;return o("div",{staticClass:"topnav"},[o("top-nav",[o("div",{staticClass:"left",attrs:{slot:"left"},on:{click:s.BackToHome},slot:"left"},[o("img",{attrs:{src:t(228),alt:""}})]),o("div",{staticClass:"center",attrs:{slot:"center"},slot:"center"},s._l(s.tablist,(function(e,t){return o("div",{staticClass:"center-item",class:{active:t===s.activeindex},on:{click:function(e){return s.changeActiveItem(t)}}},[s._v(s._s(e))])})),0)])],1)},l=[],n=t(2168),c={name:"DeTailNavBar",components:{topNav:n.Z},data(){return{activeindex:0}},props:{tablist:{type:Array,default(){return[]}}},methods:{changeActiveItem(s){this.activeindex=s,this.$emit("scrollToActiveSite",s)},BackToHome(){this.$router.back()}}},d=c,u=t(1001),g=(0,u.Z)(d,r,l,!1,null,"b352ad16",null),h=g.exports,p=function(){var s=this,e=s.$createElement,t=s._self._c||e;return t("swiper",{staticClass:"detailswiper"},s._l(s.topimges,(function(s){return t("swiper-item",[t("img",{attrs:{src:s,alt:""}})])})),1)},m=[],v=t(2225),f={name:"DetailSwiper",components:{Swiper:v.k,SwiperItem:v.t},props:{topimges:{type:Array,default(){return[]}}}},_=f,S=(0,u.Z)(_,p,m,!1,null,"71729444",null),b=S.exports,C=function(){var s=this,e=s.$createElement,t=s._self._c||e;return 0!==Object.keys(s.goodsMessage).length?t("div",{staticClass:"goodsMessage"},[t("div",{staticClass:"title"},[s._v(s._s(s.goodsMessage.title))]),t("div",{staticClass:"price"},[t("span",[s._v("￥"+s._s(s.goodsMessage.realPrice))]),t("span",[s._v(s._s(s.goodsMessage.oldPrice))]),s.goodsMessage.discount?t("div",{staticClass:"discount"},[t("span",[s._v(s._s(s.goodsMessage.discount))])]):s._e()]),t("div",{staticClass:"columns"},[t("span",[t("i",{staticClass:"iconfont"},[s._v("")]),s._v(" "+s._s(s.goodsMessage.columns[1])+" ")]),t("span",[t("i",{staticClass:"iconfont"},[s._v("")]),s._v(" "+s._s(s.goodsMessage.columns[2])+" ")]),t("span",[t("img",{attrs:{src:s.goodsMessage.services[s.goodsMessage.services.length-1].icon,alt:""}}),s._v(" "+s._s(s.goodsMessage.services[s.goodsMessage.services.length-1].name)+" ")])]),t("div",{staticClass:"services"},s._l(s.goodsMessage.services.length-1,(function(e){return t("span",[s.goodsMessage.services[e-1].icon?t("img",{attrs:{src:s.goodsMessage.services[e-1].icon,alt:""}}):s._e(),s._v(s._s(s.goodsMessage.services[e-1].name)+" ")])})),0)]):s._e()},M=[],T={name:"DetailGoodsMessage",props:{goodsMessage:{type:Object,default:{}}}},$=T,y=(0,u.Z)($,C,M,!1,null,"f5ef763c",null),I=y.exports,k=function(){var s=this,e=s.$createElement,t=s._self._c||e;return t("div",{staticClass:"shopmessage"},[t("p",[s.shopMessage.fans>1e4?t("i",{staticClass:"iconfont"},[s._v("")]):s._e(),t("span",[s._v(" 店铺信息")])]),t("div",{staticClass:"shoplogo"},[t("img",{attrs:{src:s.shopMessage.logo,alt:""}}),t("span",[s._v(s._s(s.shopMessage.name))]),t("span",[t("span",{staticClass:"iconfont"},[s._v(" ")]),s._v(s._s(s.shopMessage.fans)+"关注")])]),t("div",{staticClass:"shopser"},[t("div",{staticClass:"shop-left"},[t("div",[t("p",[s._v(s._s(s.shopMessage.sells)+"单")]),t("span",[s._v("总销量")])]),t("div",[t("p",[s._v(s._s(s.shopMessage.goodsCount)+"件")]),t("span",[s._v("全部宝贝")])])]),t("div",{staticClass:"shop-right"},s._l(s.shopMessage.score,(function(e){return t("div",[s._v(" "+s._s(e.name)+" "),e.isBetter?t("i",{staticClass:"iconfont better"},[s._v(s._s(e.score)+" ")]):t("i",{staticClass:"iconfont nobetter"},[s._v(s._s(e.score)+" ")])])})),0)]),t("a",{staticClass:"goshop",attrs:{href:"javascript:;"}},[s._v("进店逛逛")])])},w=[],z={name:"DetailShopMessage",props:{shopMessage:{type:Object,default(){return{}}}}},x=z,R=(0,u.Z)(x,k,w,!1,null,"7cddcab0",null),D=R.exports,B=function(){var s=this,e=s.$createElement,t=s._self._c||e;return t("div",{attrs:{id:"detailgoodsinfo"}},[t("div",{staticClass:"desc"},[t("span",[s._v(s._s(s.goodsInfo.desc))])]),t("div",{staticClass:"key"},[s._v(" "+s._s(s.goodsInfo.key)+" ")]),t("div",{staticClass:"imglist"},s._l(s.goodsInfo.imgList,(function(e){return t("img",{attrs:{src:e,alt:""},on:{load:s.imgLoaded}})})),0)])},L=[],E={name:"DetailShopInfo",data(){return{imgcount:0,imgListLength:0}},props:{goodsInfo:{type:Object,default(){return{}}}},methods:{imgLoaded(){this.$bus.$emit("imghasloaded")}},watch:{goodsInfo(){this.imgListLength=this.goodsInfo.imgList.length}}},A=E,Z=(0,u.Z)(A,B,L,!1,null,"94abd028",null),P=Z.exports,j=function(){var s=this,e=s.$createElement,t=s._self._c||e;return 0!=Object.keys(s.goodsSize).length?t("div",{attrs:{id:"goodssize"}},[0!=s.goodsSize.image.length?t("div",{staticClass:"image"},s._l(s.goodsSize.image,(function(e){return t("img",{attrs:{src:e,alt:""},on:{load:s.imgLoaded}})})),0):s._e(),t("table",{staticClass:"info"},[t("tr",[t("td",{attrs:{colspan:"2"}},[s._v(s._s(s.goodsSize.infokey))])]),s._l(s.goodsSize.infoset,(function(e){return t("tr",[t("td",[s._v(s._s(e.key))]),t("td",[s._v(s._s(e.value))])])})),s.goodsSize.ruledesc?t("tr",[t("td",{attrs:{colspan:"2"}},[s._v(s._s(s.goodsSize.ruledesc))])]):s._e()],2),s.goodsSize.ruletables?t("table",{staticClass:"rule"},[t("tr",[t("td",{attrs:{colspan:s.goodsSize.ruletables[0][0].length}},[s._v(s._s(s.goodsSize.rulekey))])]),s._l(s.goodsSize.ruletables[0],(function(e){return t("tr",s._l(e.length,(function(o){return t("td",[s._v(s._s(e[o-1]))])})),0)})),t("tr",[t("td",{attrs:{colspan:s.goodsSize.ruletables[0][0].length}},[s._v(s._s(s.goodsSize.ruledisclaimer))])])],2):s._e()]):s._e()},N=[],O={name:"DetailGoodsSize",props:{goodsSize:{type:Object,default(){return{}}}},methods:{imgLoaded(){this.$bus.$emit("imghasloaded")}}},G=O,U=(0,u.Z)(G,j,N,!1,null,"76130490",null),H=U.exports,F=function(){var s=this,e=s.$createElement,t=s._self._c||e;return t("div",[0!=Object.keys(s.userRate).length?t("div",{attrs:{id:"userrate"}},[t("div",{staticClass:"top"},[t("span",[s._v("用户评价 "),t("span",[s._v(s._s(s.userRate.cRate))])]),t("a",{attrs:{href:"javascript:;"}},[s._v("更多+")])]),t("div",{staticClass:"bottom"},[t("div",[t("img",{attrs:{src:s.userRate.userAvatar,alt:""}}),t("span",[s._v(s._s(s.userRate.uerName))])]),t("p",[s._v(s._s(s.userRate.content))]),t("div",[t("span",[s._v(s._s(s.Timer(s.userRate.time)))]),t("br"),t("span",[s._v("商品编号:"+s._s(s.userRate.rateId))]),t("span",[s._v(s._s(s.userRate.goodsStyle))]),s._l(s.userRate.extraInfo,(function(e){return t("span",[s._v(s._s(e))])})),t("div",s._l(s.userRate.goodsImages,(function(s){return t("img",{attrs:{src:s,alt:""}})})),0)],2)])]):t("div",{attrs:{id:"norate"}},[s._v(" 当前还无用户评价哦 ")])])},V=[],X=t(2815),q={name:"DetailUserRate",props:{userRate:{type:Object,default(){return{}}}},data(){return{realTime:""}},methods:{Timer(s){return(0,X.h)(s)}}},J=q,K=(0,u.Z)(J,F,V,!1,null,"fb0ecb0e",null),Q=K.exports,W=t(549),Y=function(){var s=this,e=s.$createElement,t=s._self._c||e;return t("div",{attrs:{id:"detailbottombar"}},[s._m(0),s._m(1),s._m(2),t("div",{staticClass:"shoppingCar",on:{click:s.addCart}},[s._v(" 加入购物车 ")]),t("div",{staticClass:"buying"},[s._v(" 购买 ")])])},ss=[function(){var s=this,e=s.$createElement,t=s._self._c||e;return t("div",{staticClass:"service"},[t("i",{staticClass:"iconfont"},[s._v("")]),t("p",[s._v("客服")])])},function(){var s=this,e=s.$createElement,t=s._self._c||e;return t("div",{staticClass:"shop"},[t("i",{staticClass:"iconfont"},[s._v("")]),t("p",[s._v("店铺")])])},function(){var s=this,e=s.$createElement,t=s._self._c||e;return t("div",{staticClass:"like"},[t("i",{staticClass:"iconfont"},[s._v("")]),t("p",[s._v("收藏")])])}],es={name:"DetailBottomBar",methods:{addCart(){this.$emit("addToCart")}}},ts=es,os=(0,u.Z)(ts,Y,ss,!1,null,"fa51bd7c",null),as=os.exports,is=t(3121),rs=t(3685);function ls(s){return(0,rs.d)({url:"/detail",params:{iid:s}})}function ns(){return(0,rs.d)({url:"/recommend"})}class cs{constructor(s,e,t){this.title=s.title,this.desc=s.desc,this.newPrice=s.price,this.oldPrice=s.oldPrice,this.discount=s.discountDesc,this.realPrice=s.lowNowPrice,this.columns=e,this.services=t}}class ds{constructor(s){this.logo=s.shopLogo,this.name=s.name,this.fans=s.cFans,this.sells=s.cSells,this.score=s.score,this.goodsCount=s.cGoods}}class us{constructor(s){this.desc=s.desc,this.key=s.detailImage[0].key,this.imgList=s.detailImage[0].list}}class gs{constructor(s){s.info.images?this.image=s.info.images:this.image=[],this.infokey=s.info.key,this.infoset=s.info.set,this.rulekey=s.rule.key,this.ruledesc=s.rule.desc,this.ruledisclaimer=s.rule.disclaimer,this.ruletables=s.rule.tables}}class hs{constructor(s,e){this.cRate=s.cRate,this.content=e.content,this.time=e.created,this.extraInfo=e.extraInfo,this.goodsImages=e.images,this.rateId=e.rateId,this.goodsStyle=e.style,this.userAvatar=e.user.avatar,this.uerName=e.user.uname}}var ps={name:"Detail",components:{DetailNavBar:h,DetailSwiper:b,DetailGoodsMessage:I,DetailShopMessage:D,DetailGoodsInfo:P,GoodsSize:gs,DetailGoodsSize:H,DetailUserRate:Q,goodsList:W.Z,DetailBottomBar:as,Scroll:i.Z},mixins:[is.M$],data(){return{iid:null,topimges:[],goodsMessage:{},shopMessage:{},goodsInfo:{},goodsSize:{},userRate:{},recommends:[],refresh:null,allScrollTops:[],getallScrollTopsByTimer:null,currentIndex:0}},created(){this.iid=this.$route.params.iid,console.log(this.iid),ls(this.iid).then((s=>{const e=s.result;this.topimges=e.itemInfo.topImages,this.goodsMessage=new cs(e.itemInfo,e.columns,e.shopInfo.services),this.shopMessage=new ds(e.shopInfo),this.goodsInfo=new us(e.detailInfo),this.goodsSize=new gs(e.itemParams),0!==e.rate.cRate&&(this.userRate=new hs(e.rate,e.rate.list[0]))})),ns().then((s=>{this.recommends=s.data.list}))},mounted(){this.refresh=(0,X.D)(this.$refs.scroller&&this.$refs.scroller.refresh,50),this.getallScrollTopsByTimer=(0,X.D)(this.getallScrollTops,50),this.$bus.$on("imghasloaded",(()=>{this.refresh(),this.getallScrollTopsByTimer()}))},destroyed(){this.$bus.$off("imghasloaded")},methods:{scrollToActiveSite(s){this.$refs.scroller.scrollTo(0,-this.allScrollTops[s],300)},getallScrollTops(){this.allScrollTops=[],this.allScrollTops.push(0),this.allScrollTops.push(this.$refs.goodsSize.$el.offsetTop-44),this.allScrollTops.push(this.$refs.userRate.$el.offsetTop-44),this.allScrollTops.push(this.$refs.recommends.$el.offsetTop-44),this.allScrollTops.push(Number.MAX_VALUE)},bescroll(s){this.IsBackTopshow(s);for(let e=0;e<this.allScrollTops.length-1;e++)this.currentIndex!==e&&-s.y>=this.allScrollTops[e]&&-s.y<this.allScrollTops[e+1]&&(this.currentIndex=e,this.$refs.NavBar.activeindex=this.currentIndex)},addToCart(){let s={};s.iid=this.iid,s.image=this.topimges[0],s.title=this.goodsMessage.title,s.desc=this.goodsMessage.desc,s.realPrice=this.goodsMessage.realPrice,s.count=1,s.checked=!0,this.$store.dispatch("addProduct",s).then((s=>{this.$toast.changeShow(s,2e3)}))}}},ms=ps,vs=(0,u.Z)(ms,o,a,!1,null,"32898978",null),fs=vs.exports},228:function(s,e,t){s.exports=t.p+"img/back.2905f178.svg"}}]);
//# sourceMappingURL=362.81abf68e.js.map