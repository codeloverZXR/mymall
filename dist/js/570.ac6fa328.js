"use strict";(self["webpackChunksupermall"]=self["webpackChunksupermall"]||[]).push([[570],{1048:function(e,t,s){s.r(t),s.d(t,{default:function(){return Y}});var o=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{attrs:{id:"home"}},[s("top-nav",{staticClass:"home-topbar"},[s("div",{attrs:{slot:"center"},slot:"center"},[e._v("购物街")])]),s("tap-control",{staticClass:"tapcontrolhidden",class:{tapcontrolfixed:e.needtapfixed},attrs:{hometabs:["流行","新款","精选"]},on:{itemclick:e.changeItem}}),s("Scroll",{ref:"scroller",attrs:{"probe-type":3,"pull-up-load":!0},on:{bescroll:e.Bescroll,pullingUp:e.upDateGoods}},[s("main-swiper",{attrs:{banners:e.banners},on:{swiperimgloaded:e.showTpclTop}}),s("home-recommend",{attrs:{recommends:e.recommends}}),s("img-recommend"),s("tap-control",{ref:"tapcontrol01",staticClass:"tapcontrol",attrs:{hometabs:["流行","新款","精选"]},on:{itemclick:e.changeItem}}),s("goods-list",{attrs:{goods:e.ShowingGoods}})],1),s("ScrollBack",{directives:[{name:"show",rawName:"v-show",value:e.isbackshow,expression:"isbackshow"}],nativeOn:{click:function(t){return e.backToTop.apply(null,arguments)}}})],1)},r=[],a=s(3685);function i(){return(0,a.d)({url:"/home/multidata",method:"get"})}function n(e,t){return(0,a.d)({url:"home/data",params:{type:e,page:t}})}var l=s(2815),c=s(2168),m=s(7957),d=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("swiper",e._l(e.banners,(function(t){return s("swiper-item",[s("a",{attrs:{href:t.link}},[s("img",{attrs:{src:t.image,alt:""},on:{load:e.SwiperImgLoaded}})])])})),1)},h=[],p=s(2225),u={name:"mainSwiper",components:{Swiper:p.k,SwiperItem:p.t},props:{banners:{type:Array,default(){return[]}}},data(){return{needEmit:!0}},methods:{SwiperImgLoaded(){this.needEmit&&(this.$emit("swiperimgloaded"),this.needEmit=!1)}}},f=u,g=s(1001),v=(0,g.Z)(f,d,h,!1,null,"19b7e052",null),b=v.exports,$=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"recommend"},e._l(e.recommends,(function(t){return s("div",{staticClass:"recommend-item"},[s("a",{attrs:{href:t.link}},[s("img",{attrs:{src:t.image,alt:""}}),s("span",[e._v(e._s(t.title))])])])})),0)},w=[],_={name:"homeRecommend",props:{recommends:{type:Array,default(){return[]}}}},k=_,x=(0,g.Z)(k,$,w,!1,null,"470728be",null),C=x.exports,y=function(){var e=this,t=e.$createElement;e._self._c;return e._m(0)},S=[function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"imgrecommend"},[o("a",{attrs:{href:"javascript:;"}},[o("img",{attrs:{src:s(8775)}})])])}],E={name:"imgRecommend"},G=E,H=(0,g.Z)(G,y,S,!1,null,"d374114a",null),T=H.exports,I=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"tap-control"},e._l(e.hometabs,(function(t,o){return s("div",{staticClass:"tap-contriol-item",class:{active:o==e.$store.state.activeindex},on:{click:function(t){return e.activeChange(o)}}},[s("span",[e._v(e._s(t))])])})),0)},Z=[],A={name:"tapControl",props:{hometabs:{type:Array,default(){return[]}}},data(){return{}},methods:{activeChange(e){this.$store.commit("changeActiveItem",e),this.$emit("itemclick")}}},B=A,R=(0,g.Z)(B,I,Z,!1,null,"5f82715a",null),D=R.exports,L=s(549),M=s(3121),j={name:"Home",components:{topNav:c.Z,mainSwiper:b,homeRecommend:C,imgRecommend:T,tapControl:D,goodsList:L.Z,Scroll:m.Z},mixins:[M.M$],data(){return{banners:[],recommends:[],goods:{pop:{page:0,list:[]},new:{page:0,list:[]},sell:{page:0,list:[]}},adciveitem:"pop",tapcontroltop:0,needtapfixed:!1,refresh:null}},activated(){null!=this.$refs.scroller.bscroll&&(this.$refs.scroller.bscroll.scrollTo(0,this.$store.state.savehomeY,0),this.$refs.scroller.bscroll.refresh(),this.refresh=(0,l.D)(this.$refs.scroller&&this.$refs.scroller.refresh,50),this.$bus.$on("imghasloaded",this.refresh))},deactivated(){null!=this.$refs.scroller.bscroll&&this.$store.commit("changeHomeY",this.$refs.scroller.bscroll.y),this.$bus.$off("imghasloaded")},created(){this.getHomeMultidata(),this.getHomeGoods("pop"),this.getHomeGoods("new"),this.getHomeGoods("sell")},computed:{ShowingGoods(){return this.goods[this.adciveitem].list}},methods:{getHomeMultidata(){i().then((e=>{this.banners=e.data.banner.list,this.recommends=e.data.recommend.list})).catch((e=>{}))},getHomeGoods(e){const t=this.goods[e].page+1;n(e,t).then((t=>{this.goods[e].list.push(...t.data.list),this.goods[e].page+=1})).catch((e=>{console.log(e)}))},changeItem(){switch(console.log(this.$store.state.activeindex),this.$store.state.activeindex){case 0:this.adciveitem="pop";break;case 1:this.adciveitem="new";break;case 2:this.adciveitem="sell";break}console.log(this.adciveitem)},Bescroll(e){this.IsBackTopshow(e),-e.y>=this.tapcontroltop-44?this.needtapfixed=!0:this.needtapfixed=!1},upDateGoods(){this.getHomeGoods(this.adciveitem),this.$refs.scroller.finishPullUp()},showTpclTop(){this.tapcontroltop=this.$refs.tapcontrol01.$el.offsetTop}}},N=j,U=(0,g.Z)(N,o,r,!1,null,"2bb09784",null),Y=U.exports},8775:function(e,t,s){e.exports=s.p+"img/recommend_bg.a1646d5d.jpg"}}]);
//# sourceMappingURL=570.ac6fa328.js.map